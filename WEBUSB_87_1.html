<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>WebUSB CH340 –¢–µ—Ä–º–∏–Ω–∞–ª (–û–¥–∏–Ω –§–∞–π–ª)</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background-color: #f4f4f9; }
        h1 { color: #333; }
        p { color: #555; }
        #output { 
            width: 100%; 
            height: 300px; 
            resize: none; 
            border: 1px solid #2c3e50; 
            padding: 10px; 
            box-sizing: border-box; 
            background-color: #ecf0f1; 
            font-family: monospace;
            font-size: 14px;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        #input-container { margin-top: 10px; display: flex; }
        #input-text { 
            flex-grow: 1; 
            padding: 8px; 
            margin-right: 10px; 
            border: 1px solid #ccc; 
            font-size: 14px;
        }
        button { 
            padding: 8px 15px; 
            cursor: pointer; 
            border: none;
            background-color: #3498db;
            color: white;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        button:hover:not(:disabled) {
            background-color: #2980b9;
        }
        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        .status-message {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
        }
        .error {
            background-color: #f39c12;
            color: white;
        }
    </style>
</head>
<body>
    <h1>WebUSB CH340 UART –¢–µ—Ä–º–∏–Ω–∞–ª üõ†Ô∏è</h1>
    <p>‚ö†Ô∏è **–í–ê–ñ–ù–û:** –î–æ—Å—Ç—É–ø –∫ WebUSB –≤–æ–∑–º–æ–∂–µ–Ω —Ç–æ–ª—å–∫–æ –ø–æ **HTTPS** –∏–ª–∏ –Ω–∞ **http://localhost**. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Chrome/Edge.</p>

    <button id="connect-button">–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ CH340</button>
    
    <h3>–í—ã–≤–æ–¥ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞:</h3>
    <textarea id="output" readonly></textarea>
    
    <div id="input-container">
        <input type="text" id="input-text" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É (Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏)...">
        <button id="send-button" disabled>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </div>

    <script>
// ====================================================
// JAVASCRIPT WEBUSB CH340 TERMINAL
// ====================================================

// --- –ö–û–ù–°–¢–ê–ù–¢–´ –î–õ–Ø CH340 ---
const USB_VENDOR_ID = 0x1A86; 
const USB_PRODUCT_ID = 0x7523; 
const INTERFACE_NUMBER = 0; 
const ENDPOINT_IN = 2;    
const ENDPOINT_OUT = 2;   
const PACKET_SIZE = 64; 

// --- –ü–ï–†–ï–ú–ï–ù–ù–´–ï –°–û–°–¢–û–Ø–ù–ò–Ø ---
let device;
let isConnected = false;

// --- DOM –≠–õ–ï–ú–ï–ù–¢–´ ---
const connectButton =